<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>FEU Operations Web Map</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        /* Sidebar */
        #sidebar {
            position: absolute;
            top: 0;
            left: 0;
            width: 260px;
            height: 100%;
            background: #ffffffee;
            padding: 20px;
            border-right: 2px solid #ddd;
            z-index: 1000;
            overflow-y: auto;
        }

        /* Map */
        #map {
            position: absolute;
            top: 0;
            left: 260px;
            right: 0;
            bottom: 0;
        }

        /* Zoom buttons */
        .zoom-box {
            position: absolute;
            top: 80px;
            left: 280px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 0 6px rgba(0,0,0,0.3);
            z-index: 900;
        }
        .zoom-box button {
            display: block;
            width: 140px;
            margin-bottom: 6px;
            cursor: pointer;
            padding: 6px;
            border-radius: 5px;
            border: 1px solid #aaa;
        }

        /* Legend */
        #legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px 14px;
            border-radius: 6px;
            box-shadow: 0 0 6px rgba(0,0,0,0.3);
            z-index: 900;
            font-size: 14px;
        }
        .legend-box {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 6px;
            border: 1px solid #000;
        }
    </style>
</head>

<body>

    <!-- Sidebar -->
    <div id="sidebar">
        <h2>FEU Operations Dashboard</h2>
        <p><strong>Total sectors:</strong> 6</p>
        <p><strong>Updated:</strong> November 2025</p>
        <hr>
        <p>Click a sector on the map for more details.</p>
    </div>

    <!-- Map -->
    <div id="map"></div>

    <!-- Zoom Buttons -->
    <div id="zoom-controls" class="zoom-box">
        <button onclick="zoomTo(upperhill)">Upperhill</button>
        <button onclick="zoomTo(eastleigh)">Eastleigh</button>
        <button onclick="zoomTo(cbd)">CBD</button>
        <button onclick="zoomTo(donholm)">Donholm–Umoja</button>
        <button onclick="zoomTo(mountainview)">Mountain View</button>
    </div>

    <!-- Legend -->
    <div id="legend">
        <h4>Legend</h4>
        <div><span class="legend-box" style="background:#e41a1c"></span> CBD</div>
        <div><span class="legend-box" style="background:#377eb8"></span> Upperhill</div>
        <div><span class="legend-box" style="background:#4daf4a"></span> Eastleigh</div>
        <div><span class="legend-box" style="background:#984ea3"></span> Donholm–Umoja</div>
        <div><span class="legend-box" style="background:#ff7f00"></span> Mountain View</div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- KML Loader -->
    <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script>

    <script>
        // Initialize map
        var map = L.map('map').setView([-1.286389, 36.817223], 12);

        // Basemap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 20
        }).addTo(map);

        // Load KML layers
        var upperhill = omnivore.kml('UPPERHILL EXTENT.kml').on('ready', function() {
            this.setStyle({color: "#377eb8", weight: 3});
        }).addTo(map);

        var eastleigh = omnivore.kml('EASTLEIGH SECTOR.kml').on('ready', function() {
            this.setStyle({color: "#4daf4a", weight: 3});
        }).addTo(map);

        var cbd = omnivore.kml('THE NAIROBI CBD.kml').on('ready', function() {
            this.setStyle({color: "#e41a1c", weight: 3});
        }).addTo(map);

        var donholm = omnivore.kml('DONHOLM_UMOJA SECTOR.kml').on('ready', function() {
            this.setStyle({color: "#984ea3", weight: 3});
        }).addTo(map);

        var mountainview = omnivore.kml('MOUNTAIN VIEW EXTENT.kml').on('ready', function() {
            this.setStyle({color: "#ff7f00", weight: 3});
        }).addTo(map);

        // Zoom-to-layer function
        function zoomTo(layer) {
            map.fitBounds(layer.getBounds());
        }

        // Example sidebar update on click
        cbd.on("click", function() {
            document.getElementById("sidebar").innerHTML = `
                <h2>Nairobi CBD</h2>
                <p><strong>Type:</strong> Commercial hub</p>
                <p><strong>Status:</strong> Active</p>
                <p><strong>Field officers:</strong> 4</p>
            `;
        });
    </script>
</body>
</html>
